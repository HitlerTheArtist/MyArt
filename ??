local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local MarketplaceService = game:GetService("MarketplaceService")

local player = Players.LocalPlayer
local gui = Instance.new("ScreenGui")
gui.Name = "AudioPlayerGUI"
gui.ResetOnSpawn = false
gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 350, 0, 240)
mainFrame.Position = UDim2.new(0.5, -175, 0.5, -120)
mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
mainFrame.BackgroundTransparency = 0.1
mainFrame.BorderSizePixel = 0
mainFrame.ClipsDescendants = true

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = mainFrame

local shadow = Instance.new("ImageLabel")
shadow.Name = "Shadow"
shadow.Image = "rbxassetid://1316045217"
shadow.ImageColor3 = Color3.new(0, 0, 0)
shadow.ImageTransparency = 0.8
shadow.ScaleType = Enum.ScaleType.Slice
shadow.SliceCenter = Rect.new(10, 10, 118, 118)
shadow.Size = UDim2.new(1, 20, 1, 20)
shadow.Position = UDim2.new(0, -10, 0, -10)
shadow.BackgroundTransparency = 1
shadow.Parent = mainFrame
shadow.ZIndex = -1

local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 40)
titleBar.Position = UDim2.new(0, 0, 0, 0)
titleBar.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
titleBar.BorderSizePixel = 0

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 12)
titleCorner.Parent = titleBar

local title = Instance.new("TextLabel")
title.Name = "Title"
title.Text = "AUDIO PLAYER"
title.Size = UDim2.new(1, 0, 0.6, 0)
title.Position = UDim2.new(0, 0, 0.1, 0)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextScaled = true
title.Font = Enum.Font.GothamBold
title.TextXAlignment = Enum.TextXAlignment.Center
title.Parent = titleBar

local credit = Instance.new("TextLabel")
credit.Name = "Credit"
credit.Text = "Script by: Wnnz"
credit.Size = UDim2.new(1, 0, 0.3, 0)
credit.Position = UDim2.new(0, 0, 0.6, 0)
credit.BackgroundTransparency = 1
credit.TextColor3 = Color3.fromRGB(180, 180, 180)
credit.TextScaled = true
credit.Font = Enum.Font.Gotham
credit.TextXAlignment = Enum.TextXAlignment.Center
credit.Parent = titleBar

local inputFrame = Instance.new("Frame")
inputFrame.Name = "InputFrame"
inputFrame.Size = UDim2.new(0.85, 0, 0, 50)
inputFrame.Position = UDim2.new(0.075, 0, 0.25, 0)
inputFrame.BackgroundTransparency = 1

local inputBox = Instance.new("TextBox")
inputBox.Name = "AudioIdInput"
inputBox.Size = UDim2.new(1, 0, 1, 0)
inputBox.Position = UDim2.new(0, 0, 0, 0)
inputBox.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
inputBox.BorderSizePixel = 0
inputBox.Text = ""
inputBox.PlaceholderText = "Enter Audio Asset ID..."
inputBox.TextColor3 = Color3.fromRGB(255, 255, 255)
inputBox.Font = Enum.Font.Gotham
inputBox.TextSize = 16
inputBox.PlaceholderColor3 = Color3.fromRGB(180, 180, 180)
inputBox.ClearTextOnFocus = false

local inputCorner = Instance.new("UICorner")
inputCorner.CornerRadius = UDim.new(0, 8)
inputCorner.Parent = inputBox

local inputPadding = Instance.new("UIPadding")
inputPadding.PaddingLeft = UDim.new(0, 10)
inputPadding.PaddingRight = UDim.new(0, 10)
inputPadding.Parent = inputBox

inputBox.Parent = inputFrame

local playButton = Instance.new("TextButton")
playButton.Name = "PlayButton"
playButton.Size = UDim2.new(0.6, 0, 0, 50)
playButton.Position = UDim2.new(0.2, 0, 0.6, 0)
playButton.BackgroundColor3 = Color3.fromRGB(70, 120, 200)
playButton.BorderSizePixel = 0
playButton.Text = "PLAY"
playButton.TextColor3 = Color3.fromRGB(255, 255, 255)
playButton.Font = Enum.Font.GothamBold
playButton.TextSize = 18

local playCorner = Instance.new("UICorner")
playCorner.CornerRadius = UDim.new(0, 8)
playCorner.Parent = playButton

local statusLabel = Instance.new("TextLabel")
statusLabel.Name = "StatusLabel"
statusLabel.Size = UDim2.new(0.8, 0, 0, 20)
statusLabel.Position = UDim2.new(0.1, 0, 0.85, 0)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = ""
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextSize = 14
statusLabel.TextXAlignment = Enum.TextXAlignment.Center

local audioNameLabel = Instance.new("TextLabel")
audioNameLabel.Name = "AudioNameLabel"
audioNameLabel.Size = UDim2.new(0.8, 0, 0, 20)
audioNameLabel.Position = UDim2.new(0.1, 0, 0.9, 0)
audioNameLabel.BackgroundTransparency = 1
audioNameLabel.Text = ""
audioNameLabel.TextColor3 = Color3.fromRGB(200, 200, 255)
audioNameLabel.Font = Enum.Font.Gotham
audioNameLabel.TextSize = 14
audioNameLabel.TextXAlignment = Enum.TextXAlignment.Center

titleBar.Parent = mainFrame
inputFrame.Parent = mainFrame
playButton.Parent = mainFrame
statusLabel.Parent = mainFrame
audioNameLabel.Parent = mainFrame
mainFrame.Parent = gui
gui.Parent = player:WaitForChild("PlayerGui")

local currentSound = nil

local function getAudioName(audioId)
    local success, result = pcall(function()
        return MarketplaceService:GetProductInfo(audioId).Name
    end)
    return success and result or "Unknown Audio"
end

playButton.MouseButton1Click:Connect(function()
    local audioId = tonumber(inputBox.Text)
    
    if not audioId then
        statusLabel.Text = "Invalid Audio ID!"
        statusLabel.TextColor3 = Color3.fromRGB(255, 80, 80)
        audioNameLabel.Text = ""
        
        local shake = 5
        for i = 1, 3 do
            inputFrame.Position = UDim2.new(0.075, shake, 0.25, 0)
            task.wait(0.05)
            inputFrame.Position = UDim2.new(0.075, -shake, 0.25, 0)
            task.wait(0.05)
        end
        inputFrame.Position = UDim2.new(0.075, 0, 0.25, 0)
        return
    end
    
    if currentSound then
        currentSound:Stop()
        currentSound:Destroy()
    end
    
    statusLabel.Text = "Loading audio..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    audioNameLabel.Text = "Fetching audio name..."
    
    playButton.TextSize = 16
    task.wait(0.1)
    playButton.TextSize = 18
    
    local sound = Instance.new("Sound")
    sound.SoundId = "rbxassetid://"..audioId
    sound.Parent = ReplicatedStorage
    sound.Name = "TempAudio_"..tick()
    
    sound.Loaded:Connect(function()
        local audioName = getAudioName(audioId)
        statusLabel.Text = "Now playing: "..audioId
        statusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        audioNameLabel.Text = "Title: "..audioName
    end)
    
    sound:Play()
    currentSound = sound
    
    sound.Ended:Connect(function()
        statusLabel.Text = "Audio finished"
        statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    end)
end)

local dragging
local dragInput
local dragStart
local startPos

local function update(input)
    local delta = input.Position - dragStart
    mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

titleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

titleBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)
